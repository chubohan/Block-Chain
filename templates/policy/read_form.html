<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>測試樣板</title>
<!-- 連結思源中文及css -->
<link href="https://fonts.googleapis.com/css?family=Noto+Sans+TC" rel="stylesheet">
<link href="/static/imgs/icon.jpg" rel="shortcut icon">
<link href="/static/css/menu.css" rel="stylesheet"/>  
<link href="/static/css/main.css" rel="stylesheet"/>      
<!------------------------->
</head>
   
<body>
    <!--**************************-->
    <div class="container">    
        <!--~~~~~~~~~~~~~~~~~-->
        <div class="header">           
        </div>        
        
        <!--~~~~~~~~~~~~~~~~~-->        
        <ul id="navigation">        
            <li><a href="/">返回主頁</a></li> 
        </ul>
        
        <!--~~~~~~~~~~~~~~~~~--> 
        <div class="content">
            
        <h2>查詢保單</h2>
        
            
        <input type="number" id="policyNumber" placeholder="輸入保單號碼">
        <button onclick="get_Policy()">查詢</button>
        <pre id="policyResult"></pre>
        
      
            <!--
            <form action="/policy/read" method="get">
                <div class="form">
                    <span class="name">客戶編號</span>
                    <span class="value">
                        <input type="text" name="cusno" required>
                    </span>
                    <br/>
                   
                    
                    <span class="name"></span>
                    <span class="value"><input type="submit" value="查詢" style="width:80px"></span>
                </div>
            </form>-->
               
        </div>       
        
        <!--~~~~~~~~~~~~~~~~~--> 
        <div class="footer">
            NTUB imd, 2023.
        </div>  
    </div>
    <!--**************************-->    
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
   
    <script>
        async function get_Policy() {
        const policyNumber = document.getElementById("policyNumber").value;
        if (!policyNumber) {
            alert("請輸入保單號碼");
            return;
        }

        const apiUrl = `http://127.0.0.1:5000/get_policy/${policyNumber}`;
        try {
            const response = await fetch(apiUrl, {
                method: "GET",
                headers: { "Content-Type": "application/json" }
            });

            if (!response.ok) {
                throw new Error(`查詢失敗: ${response.status}`);
            }

            const data = await response.json();
            document.getElementById("policyResult").textContent = JSON.stringify(data, null, 2);
        } catch (error) {
            console.error("發生錯誤:", error);
            document.getElementById("policyResult").textContent = "查詢失敗，請確認保單號碼是否正確";
        }
    }
    </script>    
   <!--**************************-->       
</body>
   
</html>
